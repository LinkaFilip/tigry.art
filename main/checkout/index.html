<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <title>Serverless payments</title>
    <script src="https://js.stripe.com/v3/"></script>
  </head>
  <body style="height: 100vh; margin: 0">
    <div
      style="
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      "
    >
      <h1 style="text-align: center">ğŸ’¸ Serverless Payment example ğŸ’¸</h1>
      <button id="checkout-button">Trigger payment</button>

      <script>
        const stripe = Stripe(
          "pk_test_51LpXXlEqK4P4Y8FRSczm8KCIMxVjzLerGMsgdEK3HeICDVhbkk94wahUTxP7BcNIMXIzmf8fSWn5GddCAVXQlBrO00WN9j5yNb"
        );

        document
          .getElementById("checkout-button")
          .addEventListener("click", () => {
            fetch("/.netlify/functions/stripe", {
              method: "POST",
            })
              .then((res) => res.json())
              .then((session) => {
                console.log("ğŸ“¦ Received session:", session);
                if (!session.id) throw new Error("Missing session ID");
                return stripe.redirectToCheckout({ sessionId: session.id });
              })
              .catch((err) => {
                console.error("âŒ Error:", err);
              });
          });
      </script>
    </div>
  </body>
</html>